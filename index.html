<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lean Training — Presenter (v7.2 resizable mini‑QR)</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
<div class="wrap">
  <header>
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 17c5-1 11-1 16 0" stroke="#7cd992" stroke-width="1.6" stroke-linecap="round"/><path d="M4 13c3-1 13-1 16 0" stroke="#58c4dc" stroke-width="1.6" stroke-linecap="round"/><path d="M4 9c2-1 7-1 10 0" stroke="#ffb86b" stroke-width="1.6" stroke-linecap="round"/><circle cx="6" cy="9" r="1.8" fill="#ffb86b"/><circle cx="12" cy="13" r="1.8" fill="#58c4dc"/><circle cx="18" cy="17" r="1.8" fill="#7cd992"/></svg>
    <h1 id="hostTitle">Lean Training — Live Session</h1>
    <div id="headerClient" class="header-user hidden"></div>
    <div id="roomBadge" class="right row mini muted">Room: <span id="roomId" class="chip mono">auto</span></div>
  </header>

  <main>
    <section id="slidesCard" class="card">
      <div class="tabs" role="tablist">
        <div class="tab" data-tab="session">Session</div>
        <div class="tab active" data-tab="presentation">Presentation</div>
        <div class="tab" data-tab="polls">Polls</div>
        <div class="tab" data-tab="leader">Leaderboard</div>
      </div>

    <!-- SESSION TAB -->
  <div id="session" class="slide">
    <section class="card" id="connectCard">
      <h2>1) Start session</h2>
      <div class="session-grid">
        <div>
          <div class="row gap12">
            <input id="wsUrl" placeholder="ws://&lt;detected-ip&gt;:8080" class="w320"/>
            <button id="connectBtn" class="pill primary">Connect</button>
            <span id="connState" class="chip">disconnected</span>
          </div>
          <div id="hostWarning" class="chip hidden session-warn">Open via <b>http://&lt;your-ip&gt;:8080</b> so phones can load it.</div>
          <p class="hint mt12 session-note">A mini QR is always visible in the top‑right. Resize it anytime by dragging the corner. Join URL: <span class="mono" id="joinUrlText"></span></p>
          <details class="mt8"><summary>Diagnostics</summary><pre id="diag" class="mini muted"></pre></details>
        </div>
      </div>
    </section>
    <section class="card" id="participantsCard">
      <h2>Participants (<span id="participantCount">0</span>)</h2>
      <div id="participantList" class="mt8 mini muted">No participants yet.</div>
    </section>
  </div>

  <!-- PRESENTATION TAB -->
  <div id="presentation" class="slide active">
    <div class="page-shell">
      <div class="pages-nav">
        <button id="prevPage" class="pill ghost">◀ Prev</button>
        <div class="dots" id="pageDots"></div>
        <button id="nextPage" class="pill ghost">Next ▶</button>
        <div class="right mini muted">Use the pen button to annotate</div>
      </div>

      <!-- PAGE 1: Craft vs Mass vs Lean -->
      <div class="page" data-page="cml">
        <div class="content">
          <div class="row justify-between items-end">
            <h2 class="m0">Craft vs Mass vs Lean</h2>
            <div class="row mini muted"><span class="chip">Topic</span><span class="chip">Interactive</span></div>
          </div>

          <div class="grid cols-2 mt10">
            <div class="card" data-step="1">
              <h2>Craft (One-off / Artisan)</h2>
              <div class="muted mini">High variety • Low volume • Expert-led</div>
              <svg id="craftViz" viewBox="0 0 320 120" class="w100p mt8">
                <defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0%" stop-color="#ffb86b"/><stop offset="100%" stop-color="#ffd7a6"/></linearGradient></defs>
                <rect x="8" y="10" width="304" height="100" rx="12" fill="#0e1622" stroke="#25334a"/>
                <circle cx="60" cy="70" r="22" fill="url(#g1)"/>
                <rect x="95" y="52" width="18" height="36" rx="4" fill="#ffd7a6"/>
                <rect x="120" y="60" width="8" height="20" rx="2" fill="#ffd7a6"/>
                <text x="18" y="28" fill="#c3d6e7" font-size="12">Skilled artisan builds end-to-end</text>
              </svg>
              <ul class="mini mt6">
                <li>• Bespoke design, long lead time</li>
                <li>• Flexible but inconsistent quality</li>
                <li>• High cost per unit</li>
              </ul>
            </div>

            <div class="card" data-step="2">
              <h2>Mass Production</h2>
              <div class="muted mini">Low variety • High volume • Dedicated lines</div>
              <svg id="massViz" viewBox="0 0 320 120" class="w100p mt8">
                <rect x="8" y="10" width="304" height="100" rx="12" fill="#0e1622" stroke="#25334a"/>
                <rect x="30" y="70" width="260" height="12" rx="6" fill="#1a2b3d"/>
                <g id="cars"></g>
                <text x="18" y="28" fill="#c3d6e7" font-size="12">Dedicated line, push scheduling</text>
              </svg>
              <button class="pill primary mt6" id="animateBtn">Run animation</button>
            </div>
          </div>

          <div class="grid cols-2 mt10">
            <div class="card" data-step="3">
              <h2>Lean Production</h2>
              <div class="muted mini">High mix • Flow • Pull • Quality at source</div>
              <svg id="leanViz" viewBox="0 0 320 120" class="w100p mt8">
                <rect x="8" y="10" width="304" height="100" rx="12" fill="#0e1622" stroke="#25334a"/>
                <path d="M26 82 Q 80 38, 150 82 T 294 82" stroke="#7cd992" stroke-width="3" fill="none"/>
                <circle cx="60" cy="82" r="6" fill="#7cd992"/>
                <circle cx="150" cy="82" r="6" fill="#7cd992"/>
                <circle cx="240" cy="82" r="6" fill="#7cd992"/>
                <text x="18" y="28" fill="#c3d6e7" font-size="12">Flow, small batches, takt & pull</text>
              </svg>
            </div>

            <div class="card" data-step="4">
              <h2>KPIs (illustrative)</h2>
              <div class="row mini muted"><span class="chip">Lead Time</span><span class="chip">Cost/Unit</span><span class="chip">Flexibility</span></div>
              <div class="grid gap10 mt8">
                <canvas id="chartLead" height="90"></canvas>
                <canvas id="chartCost" height="90"></canvas>
                <canvas id="chartFlex" height="90"></canvas>
              </div>
            </div>
          </div>

          <div class="row mini gap8 mt10 mb2" id="buildControls">
            <button id="buildPrev" class="pill ghost">◀ Step</button>
            <div class="chip" id="buildInfo">Step 0/0</div>
            <button id="buildNext" class="pill ghost">Step ▶</button>
            <label class="mini muted"><input type="checkbox" id="buildEdit"/> Edit builds</label>
            <button id="buildClear" class="pill ghost">Clear steps</button>
          </div>
        </div>

        <!-- Whiteboard overlay -->
        <canvas class="whiteboard" data-for="cml"></canvas>
        <button id="wbFab" class="fab" title="Annotate (toggle tools)">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 17l8.5-8.5a2.1 2.1 0 013 0l1 1a2.1 2.1 0 010 3L7 21l-4 1 1-5z" stroke="#9bd7ff" stroke-width="1.4"/></svg>
        </button>
        <div id="wbPanel" class="wb-panel">
          <div class="row">
            <div class="seg" id="toolSeg">
              <button data-tool="pen" class="active">Pen</button>
              <button data-tool="erase">Eraser</button>
              <button data-tool="line">Line</button>
              <button data-tool="arrow">Arrow</button>
              <button data-tool="rect">Rect</button>
              <button data-tool="ellipse">Ellipse</button>
            </div>
          </div>
          <div class="row mt8">
            <button id="colorSwatch" class="color-swatch" title="Pick color"></button>
            <input type="color" id="wbColor" value="#7cd992" class="color-hidden">
            <label>Width <input type="range" id="wbWidth" min="1" max="24" value="4"></label>
            <div id="sizeDot" class="size-dot" title="Stroke preview"></div>
          </div>
          <div class="row swatchwrap mini mt6" id="wbSwatches"></div>
          <div class="row mt8">
            <button id="wbUndo" class="pill ghost">Undo</button>
            <button id="wbRedo" class="pill ghost">Redo</button>
            <button id="wbClear" class="pill ghost">Clear</button>
            <span class="right mini muted">Draw mode: <span id="wbState">off</span></span>
          </div>
        </div>
      </div>
      <!-- /PAGE 1 -->
    </div>
  </div>

  <!-- POLLS (host) -->
  <div id="polls" class="slide">
    <div class="grid cols-2">
      <div>
        <details id="savedAcc" class="card">
          <summary>Saved polls</summary>
          <div id="savedList" class="mt12 mini muted">No saved polls.</div>
        </details>
        <details id="createAcc" class="card" open>
          <summary>Create a poll</summary>
          <div class="row gap12">
            <select id="pollType">
              <option value="mc">Multiple choice</option>
              <option value="tf">True / False</option>
              <option value="scale">1–5 Rating</option>
              <option value="rank">Ranking</option>
              <option value="open">Open text</option>
              <option value="wordcloud">Word cloud</option>
            </select>
            <input id="pollQ" placeholder="Your question" class="w360" />
            <button id="sendPoll" class="primary pill">Send to trainees</button>
            <button id="savePoll" class="pill">Save poll</button>
          </div>
          <div class="mt12" id="choicesWrap">
            <div class="row gap6 mt8"><input class="choice" placeholder="Choice A"/><input class="choice" placeholder="Choice B"/><input class="choice" placeholder="Choice C"/></div>
          </div>
          <div class="row gap12 mt12">
            <label class="mini muted"><input id="timed" type="checkbox"/> Timed (seconds)</label>
            <input id="secs" type="number" value="20" class="w80"/>
            <label class="mini muted"><input id="correctEnable" type="checkbox"/> Mark correct answer</label>
            <input id="correctKey" placeholder="A/B/C... or True/False" class="w160"/>
            <label class="mini muted" id="multiWrap"><input id="multiMC" type="checkbox"/> Allow multi-select (MC)</label>
            <label class="mini muted"><input id="scoreEnable" type="checkbox" checked/> Scoring</label>
          </div>
          <div class="row gap12 mt8">
            <label class="mini muted"><input id="allowChange" type="checkbox" checked/> Allow answer change before time ends</label>
            <label class="mini muted"><input id="wcLimit" type="number" value="3" class="w80"/> Word cloud: max words</label>
            <label class="mini muted"><input id="openChars" type="number" value="120" class="w100"/> Open text: max chars</label>
          </div>
        </details>
      </div>
      <div>
        <div class="card">
          <h2>Live results</h2>
          <div class="progress"><div id="timerBar"></div></div>
          <div id="resultsArea" class="mt12 muted">Waiting for votes…</div>
        </div>
        <div class="card" id="qaHost">
          <h2>Q&A</h2>
          <div id="qaList" class="mini muted">No questions yet.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- LEADERBOARD -->
  <div id="leader" class="slide">
    <div class="row gap12">
      <button id="resetScores" class="danger pill">Reset scores</button>
      <span class="hint">Scoring: +100 correct; 0 wrong; no speed bonus.</span>
    </div>
    <table class="leader mt12" id="leaderTable"></table>
  </div>
</section>

<!-- CLIENT VIEW (QR auto) -->
<section id="clientCard" class="card hidden">
  <h2 id="clientHeader">Join</h2>

  <div id="joinForm">
    <div id="joinPreview" class="row gap12 mb8">
      <div id="preview" class="row gap8"></div>
      <button id="joinBtn" class="primary pill">Join</button>
    </div>
    <div class="mini muted center mb8">Pick an avatar:</div>
    <div id="avatarPick" class="row gap6"></div>
  </div>

  <div class="mt12 hidden" id="clientArea"></div>
  <div id="reactRow" class="row mini gap8 mt10 hidden">
    <span class="muted">Reactions:</span>
    <div id="reactBar" class="row gap6"></div>
    <div class="right"></div>
    <button id="qaBtn" class="pill ghost">Ask a question</button>
  </div>
  <div id="qaForm" class="row hidden gap8 mt8">
    <input id="qaInput" placeholder="Type your question" class="flex1"/>
    <button id="qaSend" class="pill primary">Send</button>
  </div>
</section>
    </main>

    <footer class="mini muted center">
    <div class="row gap12">
      <span>QR-only join • Works offline on LAN</span>
      <span class="chip">Pages + Whiteboard</span>
      <span class="chip">Single-port server</span>
    </div>
  </footer>
</div>
<div id="toast" class="toast"></div>
<div id="wbIndicator" class="wb-ind">Writing: ON</div>

<!-- Always-on mini QR (resizable) -->

<div id="miniQR" class="mini-qr" title="Drag corner to resize"></div>

<script src="./savedPolls.js"></script>
<script src="./app.js"></script>

</body>
</html>
