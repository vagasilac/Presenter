<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lean Training ‚Äî Presenter (v7.2 resizable mini‚ÄëQR)</title>
  <link rel="stylesheet" href="./style.css" />
</head>
  <body>
<div class="wrap">
  <header>
    <div class="tabs" role="tablist">
      <div class="tab" data-tab="file">File</div>
      <div class="tab" data-tab="session">Session</div>
      <div class="tab active" data-tab="presentation">Presentation</div>
      <div class="tab" data-tab="polls">Polls</div>
      <div class="tab" data-tab="leader">Leaderboard</div>
    </div>
    <div class="header-sep"></div>
    <div class="row gap8" id="textToolbar">
      <select id="fontSelect">
        <option value="Arial">Arial</option>
        <option value="'Times New Roman'">Times New Roman</option>
        <option value="'Courier New'">Courier New</option>
      </select>
      <select id="fontSize">
        <option value="1">Small</option>
        <option value="3" selected>Normal</option>
        <option value="5">Large</option>
        <option value="7">Huge</option>
      </select>
      <button id="fontColorSwatch" class="color-swatch" title="Text color" style="background:#000000"></button>
      <button id="textBgSwatch" class="color-swatch" title="Textbox background color" style="background:#ffffff" disabled></button>
      <input type="color" id="fontColor" value="#000000" class="color-hidden" />
      <input type="color" id="textBg" value="#ffffff" class="color-hidden" disabled />
      <button id="textBgTransparent" class="pill" disabled>Transparent</button>
      <button id="imgBtn" class="pill" title="Insert Image">üñºÔ∏è</button>
      <button id="textBtn" class="pill" title="Insert Textbox">üìù</button>
      <input type="file" id="imgInput" accept="image/*" class="hidden" />
      <select id="imgLayer" disabled>
        <option value="1">Layer 1</option>
        <option value="2">Layer 2</option>
        <option value="3">Layer 3</option>
        <option value="4" selected>Layer 4</option>
        <option value="5">Layer 5</option>
      </select>
      <button id="deleteBtn" class="pill" disabled title="Delete">üóëÔ∏è</button>
    </div>
    <div id="roomBadge" class="row mini muted right">Room: <span id="roomId" class="chip mono">auto</span></div>
    <div class="row gap8 hidden file-menu" id="fileToolbar">
      <input id="presName" placeholder="Presentation name" class="w160" />
      <button id="presNew" class="pill">New</button>
      <button id="presSave" class="pill">Save</button>
      <select id="presList" class="w160"></select>
      <button id="presLoad" class="pill">Load</button>
    </div>
  </header>

  <main>
    <section id="slidesCard" class="card">

    <!-- SESSION TAB -->
  <div id="session" class="slide">
    <section class="card" id="connectCard">
      <h2>1) Start session</h2>
      <div class="session-grid">
        <div>
          <div class="row gap12">
            <input id="wsUrl" placeholder="ws://&lt;detected-ip&gt;:8080" class="w320"/>
            <button id="connectBtn" class="pill primary">Connect</button>
            <span id="connState" class="chip">disconnected</span>
          </div>
          <div id="hostWarning" class="chip hidden session-warn">Open via <b>http://&lt;your-ip&gt;:8080</b> so phones can load it.</div>
          <p class="hint mt12 session-note">A mini QR is always visible in the top‚Äëright. Resize it anytime by dragging the corner. Join URL: <span class="mono" id="joinUrlText"></span></p>
          <details class="mt8"><summary>Diagnostics</summary><pre id="diag" class="mini muted"></pre></details>
        </div>
      </div>
    </section>
    <section class="card" id="participantsCard">
      <h2>Participants (<span id="participantCount">0</span>)</h2>
      <div id="participantList" class="mt8">No participants yet.</div>
    </section>
  </div>

  <!-- PRESENTATION TAB -->
  <div id="presentation" class="slide active"></div>

  <!-- POLLS (host) -->
  <div id="polls" class="slide">
    <div class="grid cols-2">
      <div>
        <details id="savedAcc" class="card">
          <summary>Saved polls</summary>
          <div id="savedList" class="mt12 mini muted">No saved polls.</div>
        </details>
        <details id="createAcc" class="card" open>
          <summary>Create a poll</summary>
          <div class="row gap12">
            <select id="pollType">
              <option value="mc">Multiple choice</option>
              <option value="tf">True / False</option>
              <option value="scale">1‚Äì5 Rating</option>
              <option value="rank">Ranking</option>
              <option value="open">Open text</option>
              <option value="wordcloud">Word cloud</option>
            </select>
            <input id="pollQ" placeholder="Your question" class="w360" />
            <button id="sendPoll" class="primary pill">Send to trainees</button>
            <button id="savePoll" class="pill">Save poll</button>
          </div>
          <div class="mt12" id="choicesWrap">
            <div class="row gap6 mt8"><input class="choice" placeholder="Choice A"/><input class="choice" placeholder="Choice B"/><input class="choice" placeholder="Choice C"/></div>
          </div>
          <div class="row gap12 mt12">
            <label class="mini muted"><input id="timed" type="checkbox"/> Timed (seconds)</label>
            <input id="secs" type="number" value="20" class="w80"/>
            <label class="mini muted"><input id="correctEnable" type="checkbox"/> Mark correct answer</label>
            <input id="correctKey" placeholder="A/B/C... or True/False" class="w160"/>
            <label class="mini muted" id="multiWrap"><input id="multiMC" type="checkbox"/> Allow multi-select (MC)</label>
            <label class="mini muted"><input id="scoreEnable" type="checkbox" checked/> Scoring</label>
          </div>
          <div class="row gap12 mt8">
            <label class="mini muted"><input id="allowChange" type="checkbox" checked/> Allow answer change before time ends</label>
            <label class="mini muted"><input id="wcLimit" type="number" value="3" class="w80"/> Word cloud: max words</label>
            <label class="mini muted"><input id="openChars" type="number" value="120" class="w100"/> Open text: max chars</label>
          </div>
        </details>
      </div>
      <div>
        <div class="card">
          <h2>Live results</h2>
          <div class="progress"><div id="timerBar"></div></div>
          <div id="resultsArea" class="mt12 muted">Waiting for votes‚Ä¶</div>
        </div>
        <div class="card" id="qaHost">
          <h2>Q&A</h2>
          <div id="qaList" class="mini muted">No questions yet.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- LEADERBOARD -->
  <div id="leader" class="slide">
    <div class="row gap12">
      <button id="resetScores" class="danger pill">Reset scores</button>
      <span class="hint">Scoring: +100 correct; 0 wrong; no speed bonus.</span>
    </div>
    <table class="leader mt12" id="leaderTable"></table>
  </div>
</section>

<!-- CLIENT VIEW (QR auto) -->
<section id="clientCard" class="card hidden">
  <h2 id="clientHeader">Join</h2>

  <div id="joinForm">
    <div id="joinPreview" class="row gap12 mb8">
      <div id="preview" class="row gap8"></div>
      <button id="joinBtn" class="primary pill">Join</button>
    </div>
    <div class="mini muted center mb8">Pick an avatar:</div>
    <div id="avatarPick" class="row gap6"></div>
  </div>

  <div class="mt12 hidden" id="clientArea"></div>
  <div id="reactRow" class="row mini gap8 mt10 hidden">
    <span class="muted">Reactions:</span>
    <div id="reactBar" class="row gap6"></div>
    <div class="right"></div>
    <button id="qaBtn" class="pill ghost">Ask a question</button>
  </div>
  <div id="qaForm" class="row hidden gap8 mt8">
    <input id="qaInput" placeholder="Type your question" class="flex1"/>
    <button id="qaSend" class="pill primary">Send</button>
  </div>
</section>
    </main>

    <footer class="mini muted center">
    <div class="row gap12">
      <span>QR-only join ‚Ä¢ Works offline on LAN</span>
      <span class="chip">Pages + Whiteboard</span>
      <span class="chip">Single-port server</span>
    </div>
</footer>
</div>
<div class="pages-nav" id="navControls">
  <button id="prevPage" class="pill ghost">‚óÄ Prev</button>
  <div class="dots" id="pageDots"></div>
  <button id="nextPage" class="pill ghost">Next ‚ñ∂</button>
  <button id="presAdd" class="pill ghost">New slide</button>
  <button id="presDup" class="pill ghost">Duplicate slide</button>
  <button id="moveLeft" class="pill ghost">Move ‚óÄ</button>
  <button id="moveRight" class="pill ghost">Move ‚ñ∂</button>
</div>
<div id="toast" class="toast"></div>
<div id="wbIndicator" class="wb-ind">Writing: ON</div>

<div id="wbFab" class="fab">‚úèÔ∏è</div>
<div id="wbPanel" class="wb-panel">
  <div class="row">
    <label>Color</label>
    <div id="wbColors" class="row gap6">
      <button class="color-swatch active" data-color="#7cd992" style="background:#7cd992"></button>
      <button class="color-swatch" data-color="#58c4dc" style="background:#58c4dc"></button>
      <button class="color-swatch" data-color="#ffb86b" style="background:#ffb86b"></button>
      <button class="color-swatch" data-color="#f25f5c" style="background:#f25f5c"></button>
      <button class="color-swatch" data-color="#000000" style="background:#000000"></button>
      <label id="wbColorSwatch" for="wbColor" class="color-swatch" title="Custom color" style="background:#7cd992"></label>
    </div>
    <input type="color" id="wbColor" value="#7cd992" class="color-hidden" />
  </div>
  <div class="row mt8">
    <label>Tool</label>
    <div class="seg" id="wbTool">
      <button data-tool="pen" class="active">‚úèÔ∏è</button>
      <button data-tool="highlighter">üñçÔ∏è</button>
      <button data-tool="eraser">ü©π</button>
    </div>
  </div>
  <div class="row mt8">
    <label>Size</label>
    <div class="seg" id="wbSize">
      <button data-size="2"><span class="size-dot" style="width:4px;height:4px"></span></button>
      <button data-size="4" class="active"><span class="size-dot" style="width:8px;height:8px"></span></button>
      <button data-size="8"><span class="size-dot" style="width:12px;height:12px"></span></button>
      <button data-size="16"><span class="size-dot" style="width:20px;height:20px"></span></button>
    </div>
  </div>
  <div class="row mt8">
    <button id="wbUndo" class="pill">Undo</button>
    <button id="wbRedo" class="pill">Redo</button>
    <button id="wbClear" class="pill">Clear</button>
  </div>
</div>

<!-- Always-on mini QR (resizable) -->

<div id="miniQR" class="mini-qr" title="Drag corner to resize"></div>

<script src="./savedPolls.js"></script>
<script src="./app.js"></script>

</body>
</html>
